(self.webpackChunkmetadata_generator_vjs=self.webpackChunkmetadata_generator_vjs||[]).push([[147],{8784:(e,t,a)=>{(t=a(3645)(!1)).push([e.id,"\ndiv.xml-content[data-v-ff2958da] {\n background:rgb(246, 248, 250);\n border: 1px dotted lightgrey;\n margin: 5px 0;\n}\n",""]),e.exports=t},2147:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var i=a(3530),n=a(5582),d=a.n(n);const r={name:"IsoGenerator",components:{ViewXml:i.Z},props:{metadata:{type:Object,default:function(){}}},data:function(){return{xmlDoc:null,codeLists:{language:"http://www.loc.gov/standards/iso639-2/",charset:"http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#MD_CharacterSetCode",scope:"http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#MD_ScopeCode",role:"http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_RoleCode",dateType:"http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_DateTypeCode",progress:"http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#MD_ProgressCode",maintenance:"http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#MD_MaintenanceFrequencyCode",keywordType:"http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#MD_KeywordTypeCode",spatialRepresentation:"http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#MD_SpatialRepresentationTypeCode",link:"http://standards.iso.org/iso/19139/resources/gmxCodelists.xml#CI_OnLineFunctionCode"}}},watch:{metadata:{handler:function(e){console.log("META CHANGE"),this.createISO19139()},deep:!0}},created:function(){this.createISO19139()},methods:{exportXML:function(){var e=(new XMLSerializer).serializeToString(this.xmlDoc),t=new Blob([e],{type:"application/xml"}),a="metadata-iso19139."+d()().format("YYYYMMDD")+".xml",i=document.createElement("a");i.setAttribute("href",window.URL.createObjectURL(t)),i.setAttribute("download",a),i.click(),i.remove()},appendConstraintsTo:function(e){this.xmlDoc.createElement("gmd:resourceConstraints");var t=this.metadata.rights.filter((function(e){return"access"===e.type}));this.metadata.condition.access||t.length,t=this.metadata.rights.filter((function(e){return"access"===e.type}))},appendExtentTo:function(e){var t=this.xmlDoc.createElement("gmd:extent"),a=this.xmlDoc.createElement("gmd:EX_Extent");t.appendChild(a);var i=this,n=!1;if(this.metadata.geoLocation.forEach((function(e){e.south&&e.north&&e.east&&e.west&&(a.appendChild(i.createGeolocation(e)),n=!0)})),this.metadata.temporalExtent.start){n=!0;var d=this.xmlDoc.createElement("gmd:temporalElement"),r=this.xmlDoc.createElement("gmd:EX_TemporalExtent");d.appendChild(r);var o=this.xmlDoc.createElement("gmd:extent");r.appendChild(o);var l=this.xmlDoc.createElement("gml:TimePeriod");o.appendChild(l),l.appendChild(this.createNode("gml:beginPosition",this.metadata.temporalExtent.start)),l.appendChild(this.createNode("gml:endPosition",this.metadata.temporalExtent.end)),a.appendChild(d)}n&&e.appendChild(t)},createGeolocation:function(e){console.log(e);var t=this.xmlDoc.createElement("gmd:geographicElement"),a=this.xmlDoc.createElement("gmd:EX_GeographicBoundingBox");t.appendChild(a);var i=["west","east"];for(var n in i){var d=i[n];a.appendChild(this.createCard(e[d],"gmd:"+d+"BoundLongitude"))}for(var n in i=["south","north"])d=i[n],a.appendChild(this.createCard(e[d],"gmd:"+d+"BoundLatitude"));return t},createCard:function(e,t){console.log(e);var a=this.xmlDoc.createElement(t);return a.appendChild(this.createNode("gco:Decimal",e)),a},appendKeywordsTo:function(e){var t={gcmdKeyword:[],fmtDiscipline:[],fmtVariable:[],gcmdPlatform:[],fmtPlatform:[]},a={discipline:[],theme:[],stratum:[],place:[],temporal:[]};for(var i in this.metadata.subjects)for(var n in this.metadata.subjects[i])this.metadata.subjects[i][n].thesaurus?this.metadata.subjects[i][n].code&&t[this.metadata.subjects[i][n].thesaurus.id].push(this.metadata.subjects[i][n]):this.metadata.subjects[i][n].title[this.metadata.mainLang]&&a[this.metadata.subjects[i][n].type].push(this.metadata.subjects[i][n].title);var d=this;for(var r in a)if(a[r].length>0){var o=d.xmlDoc.createElement("gmd:descriptiveKeywords"),l=d.xmlDoc.createElement("gmd:MD_Keywords");o.appendChild(l),a[r].forEach((function(e){l.appendChild(d.createIncludeString("gmd:keyword",e,null,d.metadata.mainLang,d.metadata.langs))})),(c=d.xmlDoc.createElement("gmd:type")).appendChild(d.createNodeCode("gmd:MD_KeywordTypeCode","keywordType",r)),l.appendChild(c),e.appendChild(o)}for(var s in t)if(t[s].length>0){var c,m=t[s][0].thesaurus,h=this.metadata.mainLang;m.langs.indexOf(h)<0&&(h=m.langs[0]),o=d.xmlDoc.createElement("gmd:descriptiveKeywords"),l=d.xmlDoc.createElement("gmd:MD_Keywords"),o.appendChild(l),t[s].forEach((function(e){l.appendChild(d.createIncludeString("gmd:keyword",e.title,m.valueRoot+e.code,h,m.langs))})),(c=d.xmlDoc.createElement("gmd:type")).appendChild(d.createNodeCode("gmd:MD_KeywordTypeCode","keywordType",m.type)),l.appendChild(c);var p=this.xmlDoc.createElement("gmd:thesaurusName"),g=this.xmlDoc.createElement("gmd:CI_Citation");if(g.appendChild(this.createIncludeString("gmd:title",m.name,m.scheme,h,m.langs)),g.appendChild(this.createDate(m.date,"revision")),m.gn){var u=this.xmlDoc.createElement("gmd:identifier"),C=this.xmlDoc.createElement("gmd:MD_Identifier");u.appendChild(C);var f="external."+m.type+"."+m.gn;C.appendChild(this.createIncludeString("gmd:code","geonetwork.thesaurus."+f,"https://service.poleterresolide.fr/geonetwork/srv/eng/thesaurus.download?ref="+f,"en",["en"]))}g.appendChild(u),p.appendChild(g),l.appendChild(p),e.appendChild(o)}},createISO19139:function(){var e=this,t=new DOMParser;this.xmlDoc=t.parseFromString('<gmd:MD_Metadata xmlns:gmd="http://www.isotc211.org/2005/gmd" xmlns:gco="http://www.isotc211.org/2005/gco" xmlns:gmx="http://www.isotc211.org/2005/gmx" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:gml="http://www.opengis.net/gml/3.2" xmlns:xlink="http://www.w3.org/1999/xlink" xsi:schemaLocation="http://www.isotc211.org/2005/gmd http://schemas.opengis.net/csw/2.0.2/profiles/apiso/1.0.0/apiso.xsd"></gmd:MD_Metadata>',"text/xml");var a=this.xmlDoc.createElement("gmd:fileIdentifier"),i=this.createNode("gco:CharacterString",this.metadata.uuid);a.appendChild(i),this.xmlDoc.documentElement.appendChild(a);var n=this.xmlDoc.createElement("gmd:language");n.appendChild(this.createNodeCode("gmd:LanguageCode","language","fr"===this.metadata.mainLang?"fre":"eng","")),this.xmlDoc.documentElement.appendChild(n);var r=this.xmlDoc.createElement("gmd:characterSet");r.appendChild(this.createNodeCode("gmd:MD_CharacterSetCode","charset","utf8","")),this.xmlDoc.documentElement.appendChild(r);var o=this.xmlDoc.createElement("gmd:hierarchyLevel");o.appendChild(this.createNodeCode("gmd:MD_ScopeCode","scope","series","series")),this.xmlDoc.documentElement.appendChild(o);var l=this.xmlDoc.createElement("gmd:contact"),s=this.createContact(this.metadata.metaContact);l.appendChild(s),this.xmlDoc.documentElement.appendChild(l);var c=this.xmlDoc.createElement("gmd:dateStamp"),m=new Date,h=this.createNode("gco:DateTime",d().utc(m).format());c.appendChild(h),this.xmlDoc.documentElement.appendChild(c);var p=this.xmlDoc.createElement("gmd:metadataStandardName");if(i=this.createNode("gco:CharacterString","ISO 19115:3/19139"),p.appendChild(i),this.xmlDoc.documentElement.appendChild(p),p=this.xmlDoc.createElement("gmd:metadataStandardVersion"),i=this.createNode("gco:CharacterString","1.0"),p.appendChild(i),this.xmlDoc.documentElement.appendChild(p),this.metadata.langs.length>1){var g=this.xmlDoc.createElement("gmd:locale");this.metadata.langs.forEach((function(t){var a=e.xmlDoc.createElement("gmd:PT_Locale");a.setAttribute("id",t.toUpperCase());var i=e.xmlDoc.createElement("gmd:languageCode");i.appendChild(e.createNodeCode("gmd:LanguageCode","language","fr"===t?"fre":"eng",null)),a.appendChild(i);var n=e.xmlDoc.createElement("gmd:characterEncoding");n.appendChild(e.createNodeCode("gmd:MD_CharacterSetCode","charset","utf8",null)),a.appendChild(n),g.appendChild(a)})),this.xmlDoc.documentElement.appendChild(g)}var u=this.xmlDoc.createElement("gmd:referenceSystemInfo"),C=this.xmlDoc.createElement("gmd:MD_ReferenceSystem");u.appendChild(C);var f=this.xmlDoc.createElement("gmd:referenceSystemIdentifier");C.appendChild(f),a=this.xmlDoc.createElement("gmd:RS_Identifier"),f.appendChild(a),i=this.createIncludeString("gmd:code",this.metadata.referentiel.name,this.metadata.referentiel.link,this.metadata.mainLang,this.metadata.langs),a.appendChild(i),this.xmlDoc.documentElement.appendChild(u),this.appendDataIdentification(),this.appendDistributionInfo()},createNode:function(e,t){var a=this.xmlDoc.createElement(e);return null!==t&&a.appendChild(this.xmlDoc.createTextNode(t)),a},appendDataIdentification:function(){var e=this,t=this.xmlDoc.createElement("gmd:identificationInfo");this.xmlDoc.documentElement.appendChild(t);var a=this.xmlDoc.createElement("gmd:MD_DataIdentification");t.appendChild(a);var i=this.xmlDoc.createElement("gmd:citation");a.appendChild(i);var n=this.xmlDoc.createElement("gmd:CI_Citation");i.appendChild(n),this.metadata.title[this.metadata.mainLang]&&n.appendChild(this.createIncludeString("gmd:title",this.metadata.title,null,this.metadata.mainLang,this.metadata.langs));var d=this.metadata.dates.filter((function(e){return"Created"===e.type}));d.sort((function(e,t){return e.date>t.date?-1:1})),d[0]&&d[0].date&&n.appendChild(this.createDate(d[0].date,"creation")),this.metadata.publicationDate&&n.appendChild(this.createDate(this.metadata.publicationDate,"publication"));var r=this.metadata.dates.filter((function(e){return"Updated"===e.type}));r.sort((function(e,t){return e.date>t.date?-1:1})),r[0]&&r[0].date&&n.appendChild(this.createDate(r[0].date,"revision")),this.metadata.identifiers.forEach((function(t){t.identifier&&n.appendChild(e.createIdentifier(t.identifier))})),this.metadata.descriptions.Abstract[this.metadata.mainLang]&&a.appendChild(this.createIncludeString("gmd:abstract",this.metadata.descriptions.Abstract,null,this.metadata.mainLang,this.metadata.langs));var o=this.xmlDoc.createElement("gmd:status");if(o.appendChild(this.createNodeCode("gmd:MD_ProgressCode","progress",this.metadata.status)),a.appendChild(o),this.metadata.publisher.fullName){var l=this.xmlDoc.createElement("gmd:pointOfContact");l.appendChild(this.createContact(this.metadata.publisher)),a.appendChild(l)}this.metadata.creators.forEach((function(t){if(t.fullName&&"distributor"!==t.role){var i=e.xmlDoc.createElement("gmd:pointOfContact");i.appendChild(e.createContact(t)),a.appendChild(i)}})),this.metadata.contributors.forEach((function(t){if(t.fullName&&"distributor"!==t.role){var i=e.xmlDoc.createElement("gmd:pointOfContact");i.appendChild(e.createContact(t)),a.appendChild(i)}}));var s=this.xmlDoc.createElement("gmd:resourceMaintenance"),c=this.xmlDoc.createElement("gmd:MD_MaintenanceInformation");s.appendChild(c);var m=this.xmlDoc.createElement("gmd:maintenanceAndUpdateFrequency");c.appendChild(m),m.appendChild(this.createNodeCode("gmd:MD_MaintenanceFrequencyCode","maintenance",this.metadata.maintenance)),a.appendChild(s),this.appendKeywordsTo(a);var h=this.xmlDoc.createElement("gmd:spatialRepresentationType");h.appendChild(this.createNodeCode("gmd:MD_SpatialRepresentationTypeCode","spatialRepresentation",this.metadata.representationType)),a.appendChild(h),this.metadata.resolutions.forEach((function(t){if(t.value){var i=e.xmlDoc.createElement("gmd:spatialResolution"),n=e.xmlDoc.createElement("gmd:MD_Resolution");i.appendChild(n);var d=e.xmlDoc.createElement("gmd:distance");n.appendChild(d);var r=e.createNode("gco:Distance",t.value);r.setAttribute("uom",t.unit),d.appendChild(r),a.appendChild(i)}}));var p=this.xmlDoc.createElement("gmd:language");p.appendChild(e.createNodeCode("gmd:LanguageCode","language","fr"===this.metadata.language?"fre":"eng",null)),a.appendChild(p);var g=this.xmlDoc.createElement("gmd:characterSet");g.appendChild(this.createNodeCode("gmd:MD_CharacterSetCode","charset",this.metadata.charset)),a.appendChild(g);var u=this.xmlDoc.createElement("gmd:topicCategory");u.appendChild(this.createNode("gmd:MD_TopicCategoryCode","geoscientificInformation")),a.appendChild(u),this.appendExtentTo(a)},appendDistributionInfo:function(){var e=!1,t=this.xmlDoc.createElement("gmd:distributionInfo"),a=this.xmlDoc.createElement("gmd:MD_Distribution");t.appendChild(a);var i=this;this.metadata.formats.length>0&&this.metadata.formats.forEach((function(t){if(t){e=!0;var n=i.xmlDoc.createElement("gmd:distributionFormat"),d=i.xmlDoc.createElement("gmd:MD_Format");n.appendChild(d),d.appendChild(i.createIncludeString("gmd:name",t,null,i.metadata.mainLang,i.metadata.langs)),a.appendChild(n)}}));var n=this.metadata.creators.filter((function(e){return"distributor"===e.role}));this.metadata.contributors.forEach((function(e){"distributor"===e.role&&n.push(e)})),console.log(n),n.length>0&&n.forEach((function(t){if(t.fullName){var n=i.xmlDoc.createElement("gmd:distributor"),d=i.xmlDoc.createElement("gmd:MD_Distributor");n.appendChild(d);var r=i.xmlDoc.createElement("gmd:distributorContact");r.appendChild(i.createContact(t)),d.appendChild(r),a.appendChild(d),e=!0}}));var d=!1,r=this.xmlDoc.createElement("gmd:transferOptions"),o=this.xmlDoc.createElement("MD_DigitalTransferOptions");r.appendChild(o),this.metadata.doi&&(d=!0,r.appendChild(this.createDoi(this.metadata.doi))),this.metadata.links.length>0&&this.metadata.links.forEach((function(e){e.url&&(r.appendChild(i.createOnLine(e)),d=!0)})),d&&(t.appendChild(r),e=!0),e&&this.xmlDoc.documentElement.appendChild(t)},createDoi:function(e){var t={type:"DOI",url:e,typeiso:"information",title:"doi:"+e,description:{fr:"Page de doi:"+e,en:"Landing page doi:"+e}};return this.createOnLine(t)},createOnLine:function(e){var t=this.xmlDoc.createElement("gmd:onLine"),a=this.xmlDoc.createElement("gmd:CI_OnLineResource");t.appendChild(a);var i=this.xmlDoc.createElement("gmd:linkage"),n=e.url,d=e.protocole;e.type&&(d="WWW:LINK-1.0-http--link","DOI"===e.type&&(n="https://www.doi.org/"+e.url)),i.appendChild(this.createNode("gmd:URL",n)),a.appendChild(i),a.appendChild(this.createIncludeString("gmd:protocol",d,null,"en",["en"])),a.appendChild(this.createIncludeString("gmd:name",e.title,null,this.metadata.mainLang,this.metadata.langs)),a.appendChild(this.createIncludeString("gmd:description",e.description,null,this.metadata.mainLang,this.metadata.langs));var r=this.xmlDoc.createElement("gmd:function");return r.appendChild(this.createNodeCode("gmd:CI_OnLineFunctionCode","link",e.typeiso)),a.appendChild(r),t},createNodeCode:function(e,t,a,i){if(i)var n=this.createNode(e,i);else n=this.xmlDoc.createElement(e);return n.setAttribute("codeList",this.codeLists[t]),n.setAttribute("codeListValue",a),n},createIdentifier:function(e,t){var a=this.xmlDoc.createElement("gmd:identifier"),i=this.xmlDoc.createElement("gmd:MD_Identifier");return a.appendChild(i),i.appendChild(this.createIncludeString("gmd:code",e,t,"en",["en"])),a},createDate:function(e,t){var a=this.xmlDoc.createElement("gmd:date"),i=this.xmlDoc.createElement("gmd:CI_Date");a.appendChild(i);var n=this.xmlDoc.createElement("gmd:date");return i.appendChild(n),n.appendChild(this.createNode("gco:Date",e)),n=this.xmlDoc.createElement("gmd:dateType"),i.appendChild(n),n.appendChild(this.createNodeCode("gmd:CI_DateTypeCode","dateType",t)),a},createContact:function(e){var t=this.xmlDoc.createElement("gmd:CI_ResponsibleParty");if("Personal"===e.nameType){var a=this.createIncludeString("gmd:individualName",e.fullName,e.identifier,this.metadata.mainLang,this.metadata.langs);t.appendChild(a)}if("Organizational"===e.nameType)var i={name:e.fullName,identifier:e.identifier};else e.affiliations.length>0&&(i=e.affiliations[0]);if(i){var n=this.createIncludeString("gmd:organisationName",i.name,i.identifier,this.metadata.mainLang,this.metadata.langs);t.appendChild(n)}if(e.email){var d=this.xmlDoc.createElement("gmd:contactInfo"),r=this.xmlDoc.createElement("gmd:CI_Contact");d.appendChild(r);var o=this.xmlDoc.createElement("gmd:address");r.appendChild(o);var l=this.xmlDoc.createElement("gmd:CI_Address");o.appendChild(l),l.appendChild(this.createIncludeString("gmd:electronicMailAddress",e.email,null,this.metadata.mainLang,this.metadata.langs)),t.appendChild(d)}var s=this.xmlDoc.createElement("gmd:role");return s.appendChild(this.createNodeCode("gmd:CI_RoleCode","role",e.role,"")),t.appendChild(s),t},createNeededString:function(e,t){var a=this.xmlDoc.createElement(e);return t?a.appendChild(this.createNode("gco:CharacterString",t)):(a.setAttribute("gco:nilReason","missing"),a.appendChild(this.xmlDoc.createElement("gco:CharacterString"))),a},createIncludeString:function(e,t,a,i,n){var d=this.xmlDoc.createElement(e),r={};if("string"==typeof t)r={fr:t,en:t};else for(var o in r=t,t)null===r[o]&&(r[o]="");if(a){var l=this.createNode("gmx:Anchor",r[i]);if("string"==typeof a)l.setAttribute("xlink:href",a);else if(a.identifier)switch(a.type){case"ORCID":l.setAttribute("xlink:href","https://orcid.org/"+a.identifier);break;case"ISNI":l.setAttribute("xlink:href","https://www.isni.org/"+a.identifier);break;case"ROR":l.setAttribute("xlink:href","https://ror.org/"+a.identifier)}else l=this.createNode("gco:CharacterString",r[i])}else l=this.createNode("gco:CharacterString",r[i]);if(d.appendChild(l),n.length>1){d.setAttribute("xsi:type","gmd:PT_FreeText_PropertyType");var s=this.xmlDoc.createElement("gmd:PT_FreeText"),c=this;n.forEach((function(e){var t=c.xmlDoc.createElement("gmd:textGroup"),a=c.createNode("gmd:LocalisedCharacterString",r[e]);a.setAttribute("locale","#"+e.toUpperCase()),t.appendChild(a),s.appendChild(t)})),d.appendChild(s)}return d},generateSubject:function(e){var t=[],a=this.metadata.langs;e.thesaurus&&(a=this.metadata.langs.filter((function(t){return e.thesaurus.langs.includes(t)})));var i=this;return a.forEach((function(a){if(e.title[a]){var n=i.createNode("subject",e.title[a]);n.setAttribute("xml:lang",a),e.thesaurus&&e.code&&(n.setAttribute("subjectScheme",e.thesaurus.name),n.setAttribute("schemeURI",e.thesaurus.schemeUrl),n.setAttribute("valueURI",e.thesaurus.valueRoot+e.code),n.setAttribute("classificationCode",e.code)),t.push(n)}})),t}}};a(1800);const o=(0,a(1900).Z)(r,(function(){var e=this,t=e._self._c;return t("span",[t("div",{staticClass:"header"},[t("h3",{staticStyle:{"margin-top":"0"}},[e._v("Format ISO19139")]),e._v(" "),e._m(0),e._v(" "),t("div",[e._v("\n      Fiche Générée "),t("input",{attrs:{type:"button",value:"Exporter"},on:{click:e.exportXML}})])]),e._v(" "),t("div",{staticClass:"xml-content"},[e.xmlDoc?t("view-xml",{attrs:{element:e.xmlDoc.documentElement,deployed:!1,depth:0}}):e._e()],1)])}),[function(){var e=this,t=e._self._c;return t("div",[e._v("\n    Pour plus d'information consultez la documentation \n    sur: \n    "),t("ul",{staticStyle:{margin:"5px 0 10px 0"}},[t("li",[t("a",{attrs:{href:"http://cnig.gouv.fr/wp-content/uploads/2019/05/Guide-de-saisie-des-%C3%A9l%C3%A9ments-de-m%C3%A9tadonn%C3%A9es-INSPIRE-v2.0.pdf",target:"_blank"}},[e._v("\n\t\t     Guide de saisie des métadonnées INSPIRE (CNIG)\n\t\t     ")])]),e._v(" "),t("li",[e._v("\n         ou "),t("a",{attrs:{href:"https://github.com/INSPIRE-MIF/technical-guidelines/blob/2022.1/metadata/metadata-iso19139/metadata-iso19139.adoc",target:"_blank"}},[e._v("\n         Technical Guidance for implementation of INSPIRE dataset and service metadata based on ISO/TS 19139:2007\n         ")])])])])}],!1,null,"ff2958da",null).exports},1800:(e,t,a)=>{var i=a(8784);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals),(0,a(5346).Z)("832cbf68",i,!0,{})}}]);
//# sourceMappingURL=147.metadata-generator-vjs.js.map