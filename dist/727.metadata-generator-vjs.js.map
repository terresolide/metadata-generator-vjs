{"version":3,"file":"727.metadata-generator-vjs.js","mappings":"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","sources":["webpack://metadata-generator-vjs/./src/draw-bbox.vue?af24","webpack://metadata-generator-vjs/./src/draw-bbox.vue?585c","webpack://metadata-generator-vjs/./src/draw-bbox.vue","webpack://metadata-generator-vjs/src/draw-bbox.vue","webpack://metadata-generator-vjs/./src/draw-bbox.vue?bdef","webpack://metadata-generator-vjs/./src/draw-bbox.vue?7ed3","webpack://metadata-generator-vjs/./src/draw-bbox.vue?3b36","webpack://metadata-generator-vjs/./src/draw-bbox.vue?c705"],"sourcesContent":["// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\\ndiv[id=\\\"map\\\"] {\\n  position:relative;\\n  min-height: 500px;\\n}\\ndiv[id=\\\"map\\\"] a.leaflet-draw-draw-rectangle:before{\\n  content:\\\"\\\\f04d\\\";\\n  font-family: \\\"FontAwesome\\\"\\n}\\ndiv[id=\\\"map\\\"] a.leaflet-draw-edit-edit:before{\\n  content:\\\"\\\\f040\\\";\\n  font-family: \\\"FontAwesome\\\"\\n}\\ndiv[id=\\\"map\\\"] a.leaflet-draw-edit-remove:before{\\n  content:\\\"\\\\f1f8\\\";\\n  font-family: \\\"FontAwesome\\\"\\n}\\n\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"\\n.draw-bbox[data-v-297e994a] {\\n  position: fixed;\\n  width: 45%;\\n  height:500px;\\n  top: 10%;\\n  left: 45%;\\n  background: white;\\n  border:5px solid grey;\\n}\\n\", \"\"]);\n// Exports\nmodule.exports = exports;\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"draw-bbox\"},[_c('div',{staticClass:\"fa fa-close\",staticStyle:{\"position\":\"absolute\",\"top\":\"0\",\"right\":\"0px\",\"z-index\":\"100\",\"background\":\"white\"},on:{\"click\":_vm.close}}),_vm._v(\" \"),_c('div',{staticStyle:{\"z-index\":\"0\"},attrs:{\"id\":\"map\"}})])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n<div class=\"draw-bbox\">\n   <div style=\"position:absolute;top:0;right:0px;z-index:100;background:white;\" class=\"fa fa-close\" @click=\"close\"></div>\n   <div id=\"map\" style=\"z-index:0;\"></div>\n</div>\n</template>\n<script>\nimport L from 'leaflet'\nrequire('leaflet-draw')\n// L.modLat = function( lat ){\n//      lat = lat%180;\n//      if( lat > 90 ){\n//           lat -= 180;\n//      }else if( lat < -90 ){\n//           lat += 180;\n//      }\n//      return Math.round(lat * 100000) / 100000;\n// }\nL.modLng = function( lng ){\n     lng = lng%360;\n     if( lng > 180 ){\n          lng -= 360;\n     }else if( lng < -180 ){\n          lng += 360;\n     }\n     return lng;\n}\nfunction round (value, decimal) {\n   return Math.round(value * Math.pow(10, decimal)) / Math.pow(10, decimal)\n}\nexport default {\n  name: 'DrawBbox',\n  props: {\n    id: {\n      type: Number,\n      default: null\n    },\n    bboxes: {\n      type: Array,\n      default: null\n    }\n  },\n  watch: {\n    id (newvalue) {\n      this.drawBboxes()\n    },\n    bboxes: {\n      handler () {\n        this.drawBboxes()\n      },\n      deep: true\n    }\n  },\n  created () {\n  },\n  mounted () {\n    this.initialize()\n  },\n  data () {\n    return {\n      bbox: null,\n      map: null,\n      drawControl: null,\n      drawLayers: null,\n      bboxesLayers: null\n    }\n  },\n  methods: {\n    change () {\n      var bbox = Object.assign(this.bboxes[this.id], this.bbox)\n      this.$emit('change', {id: this.id, bbox: bbox})\n    },\n    close () {\n      this.$emit('close')\n    },\n    drawBboxes () {\n      var _this = this\n      var bounds = null\n      if (this.bboxesLayers) {\n        this.bboxesLayers.clearLayers()\n      } else {\n        this.bboxesLayers = L.featureGroup()\n        this.bboxesLayers.addTo(this.map)\n      }\n      if (this.drawLayers) {\n        this.drawLayers.clearLayers()\n      } else {\n        this.drawLayers = L.featureGroup()\n        this.drawLayers.addTo(this.map)\n      }\n      this.bboxes.forEach(function (geolocation, index) {\n        if ( geolocation.east && geolocation.west && geolocation.north && geolocation.south) {\n          var latlngBounds = [\n            [geolocation.north, geolocation.east], \n            [geolocation.south, geolocation.west]]\n          if (index === _this.id)  {\n            var rectangle = L.rectangle(\n              latlngBounds,\n              {color: 'red', weight: 1})\n             .bindPopup('<b>Bbox N°' + (index + 1) + '</b>' + (geolocation.name ? '<br>' + geolocation.name : ''))\n             _this.drawLayers.addLayer(rectangle)\n            bounds = L.latLngBounds(latlngBounds)\n          } else {\n            var rectangle = L.rectangle(\n              latlngBounds,\n              {color: 'blue', weight: 1})\n             .bindPopup('<b>Bbox N°' + (index + 1) + '</b>' + (geolocation.name ? '<br>' + geolocation.name : ''))\n             _this.bboxesLayers.addLayer(rectangle)\n          }\n        } \n      })\n      if (bounds) {\n        this.map.fitBounds(bounds, {padding: [10, 10]})\n      } else {\n        bounds = this.bboxesLayers.getBounds()\n        if (bounds.isValid()) {\n          this.map.fitBounds(bounds, {padding: [20, 30]})\n        }\n      }\n    },\n    drawValidBbox (bounds) {\n      if (!this.drawLayers) {\n        return\n      }\n      if (!bounds) {\n        return null\n      }\n      let bbox = { \n        north: round(bounds.getNorth(), 6),\n        south: round(bounds.getSouth(), 6),\n        east: round(bounds.getEast(), 6),\n        west: round(bounds.getWest(), 6)\n      }\n      // valid bbox\n      if (bbox.east > 180 || bbox.west < -180) {\n         var delta = bbox.east - bbox.west\n         if ( delta > 360) {\n           bbox.east = 180\n           bbox.west = -180\n         }else {\n           bbox.west = L.modLng(bbox.west);\n           bbox.west = bbox.west === 180 ? -180 : bbox.west\n           bbox.east = Math.min(bbox.west + delta, 180)\n         }\n      }\n      // draw or redraw if bbox change\n      var bounds = [[bbox.south, bbox.west], [bbox.north, bbox.east]]\n      var rectangle = L.rectangle(bounds, {color: '#ff0000'})\n      this.drawLayers.clearLayers()\n      this.drawLayers.addLayer(rectangle)\n      bounds = this.drawLayers.getBounds()\n      return bbox;\n    },\n    initialize () {\n      if (this.map) {\n        return;\n      }\n      var container = this.$el.querySelector('#map');\n      this.map = L.map( container).setView([51.505, -0.09], 2);\n            \n      L.tileLayer('//server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}',\n        {\n          attribution: 'Tiles © <a href=\"https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer\">ArcGIS</a>',\n          maxZoom: 18,\n          minZoom:1\n        }).addTo( this.map )\n      this.drawBboxes()\n      this.initDrawControl()\n    },\n    initDrawControl() {\n      if (this.drawControl) {\n        return\n      }\n      this.drawControl = new L.Control.Draw({\n        draw: {\n          rectangle: {\n            shapeOptions: {\n              color: '#ff0000'\n            }\n          },\n          circlemarker: false,\n          circle: false,\n          marker: false,\n          polygon: false,\n          polyline: false\n        },\n        edit: {\n          featureGroup: this.drawLayers\n        }\n      })\n      this.drawControl.addTo(this.map)\n      var self = this\n      this.map.on(L.Draw.Event.CREATED, function (e) {\n        let layer = e.layer\n        let bounds = e.layer.getBounds()\n        self.bbox = self.drawValidBbox(bounds)\n        self.change()\n      })\n    \n      this.map.on(L.Draw.Event.EDITED, function (e) {\n        let bounds\n        e.layers.eachLayer(function (layer) {\n          bounds = layer.getBounds()\n        })\n        self.bbox = self.drawValidBbox(bounds)\n        self.change()\n      })\n    \n      this.map.on(L.Draw.Event.DELETED , function (e) {\n        self.bbox = { \n          north: '',\n          south: '',\n          east: '',\n          west: ''\n        }\n        self.change()\n      })\n    }\n  }\n}\n</script>\n<style src=\"leaflet/dist/leaflet.css\"></style>\n<style src=\"leaflet-draw/dist/leaflet.draw.css\"></style>\n<style>\n  div[id=\"map\"] {\n    position:relative;\n    min-height: 500px;\n  }\n  div[id=\"map\"] a.leaflet-draw-draw-rectangle:before{\n    content:\"\\f04d\";\n    font-family: \"FontAwesome\"\n  }\n  div[id=\"map\"] a.leaflet-draw-edit-edit:before{\n    content:\"\\f040\";\n    font-family: \"FontAwesome\"\n  }\n  div[id=\"map\"] a.leaflet-draw-edit-remove:before{\n    content:\"\\f1f8\";\n    font-family: \"FontAwesome\"\n  }\n</style>\n<style scoped>\n.draw-bbox {\n  position: fixed;\n  width: 45%;\n  height:500px;\n  top: 10%;\n  left: 45%;\n  background: white;\n  border:5px solid grey;\n}\n</style>","import mod from \"-!../node_modules/babel-loader/lib/index.js!../node_modules/vue-loader/lib/index.js??vue-loader-options!./draw-bbox.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js!../node_modules/vue-loader/lib/index.js??vue-loader-options!./draw-bbox.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./draw-bbox.vue?vue&type=template&id=297e994a&scoped=true\"\nimport script from \"./draw-bbox.vue?vue&type=script&lang=js\"\nexport * from \"./draw-bbox.vue?vue&type=script&lang=js\"\nimport style0 from \"leaflet/dist/leaflet.css?vue&type=style&index=0&prod&lang=css&external\"\nimport style1 from \"leaflet-draw/dist/leaflet.draw.css?vue&type=style&index=1&prod&lang=css&external\"\nimport style2 from \"./draw-bbox.vue?vue&type=style&index=2&id=297e994a&prod&lang=css\"\nimport style3 from \"./draw-bbox.vue?vue&type=style&index=3&id=297e994a&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"297e994a\",\n  null\n  \n)\n\nexport default component.exports","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../node_modules/css-loader/dist/cjs.js!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/vue-loader/lib/index.js??vue-loader-options!./draw-bbox.vue?vue&type=style&index=2&id=297e994a&prod&lang=css\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"14d5af98\", content, true, {});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../node_modules/css-loader/dist/cjs.js!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/vue-loader/lib/index.js??vue-loader-options!./draw-bbox.vue?vue&type=style&index=3&id=297e994a&prod&scoped=true&lang=css\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"7159d024\", content, true, {});"],"names":["exports","___CSS_LOADER_API_IMPORT___","push","module","id","round","value","decimal","Math","pow","require","L","lng","name","props","type","Number","bboxes","Array","watch","newvalue","drawBboxes","handler","deep","created","mounted","initialize","data","bbox","map","drawControl","drawLayers","bboxesLayers","methods","change","Object","assign","$emit","close","_this","bounds","clearLayers","addTo","forEach","geolocation","index","east","west","north","south","latlngBounds","rectangle","color","weight","bindPopup","addLayer","fitBounds","padding","getBounds","isValid","drawValidBbox","getNorth","getSouth","getEast","getWest","delta","min","container","$el","querySelector","setView","attribution","maxZoom","minZoom","initDrawControl","Draw","draw","shapeOptions","circlemarker","circle","marker","polygon","polyline","edit","featureGroup","self","on","Event","CREATED","e","layer","EDITED","layers","eachLayer","DELETED","_vm","this","_c","_self","staticClass","staticStyle","_v","attrs","content","__esModule","default","locals","add"],"sourceRoot":""}