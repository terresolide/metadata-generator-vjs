(self.webpackChunkmetadata_generator_vjs=self.webpackChunkmetadata_generator_vjs||[]).push([[776],{4707:(e,t,a)=>{(t=a(3645)(!1)).push([e.id,'\ndiv[id="map"] {\n  position:relative;\n  min-height: 500px;\n}\ndiv[id="map"] a.leaflet-draw-draw-rectangle:before{\n  content:"\\f04d";\n  font-family: "FontAwesome"\n}\ndiv[id="map"] a.leaflet-draw-edit-edit:before{\n  content:"\\f040";\n  font-family: "FontAwesome"\n}\ndiv[id="map"] a.leaflet-draw-edit-remove:before{\n  content:"\\f1f8";\n  font-family: "FontAwesome"\n}\n',""]),e.exports=t},1217:(e,t,a)=>{(t=a(3645)(!1)).push([e.id,"\n.draw-bbox[data-v-297e994a] {\n  position: fixed;\n  width: 45%;\n  height:500px;\n  top: 10%;\n  left: 45%;\n  background: white;\n  border:5px solid grey;\n}\n",""]),e.exports=t},776:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var r=a(5243),s=a.n(r);function o(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}a(1787),s().modLng=function(e){return(e%=360)>180?e-=360:e<-180&&(e+=360),e};const n={name:"DrawBbox",props:{id:{type:Number,default:null},bboxes:{type:Array,default:null}},watch:{id:function(e){this.drawBboxes()},bboxes:{handler:function(){this.drawBboxes()},deep:!0}},created:function(){},mounted:function(){this.initialize()},data:function(){return{bbox:null,map:null,drawControl:null,drawLayers:null,bboxesLayers:null}},methods:{change:function(){var e=Object.assign(this.bboxes[this.id],this.bbox);this.$emit("change",{id:this.id,bbox:e})},close:function(){this.$emit("close")},drawBboxes:function(){var e=this,t=null;this.bboxesLayers?this.bboxesLayers.clearLayers():(this.bboxesLayers=s().featureGroup(),this.bboxesLayers.addTo(this.map)),this.drawLayers?this.drawLayers.clearLayers():(this.drawLayers=s().featureGroup(),this.drawLayers.addTo(this.map)),this.bboxes.forEach((function(a,r){if(a.east&&a.west&&a.north&&a.south){var o=[[a.north,a.east],[a.south,a.west]];if(r===e.id){var n=s().rectangle(o,{color:"red",weight:1}).bindPopup("<b>Bbox N°"+(r+1)+"</b>"+(a.name?"<br>"+a.name:""));e.drawLayers.addLayer(n),t=s().latLngBounds(o)}else n=s().rectangle(o,{color:"blue",weight:1}).bindPopup("<b>Bbox N°"+(r+1)+"</b>"+(a.name?"<br>"+a.name:"")),e.bboxesLayers.addLayer(n)}})),t?this.map.fitBounds(t,{padding:[10,10]}):(t=this.bboxesLayers.getBounds()).isValid()&&this.map.fitBounds(t,{padding:[20,30]})},drawValidBbox:function(e){if(this.drawLayers){if(!e)return null;var t={north:o(e.getNorth(),6),south:o(e.getSouth(),6),east:o(e.getEast(),6),west:o(e.getWest(),6)};if(t.east>180||t.west<-180){var a=t.east-t.west;a>360?(t.east=180,t.west=-180):(t.west=s().modLng(t.west),t.west=180===t.west?-180:t.west,t.east=Math.min(t.west+a,180))}e=[[t.south,t.west],[t.north,t.east]];var r=s().rectangle(e,{color:"#ff0000"});return this.drawLayers.clearLayers(),this.drawLayers.addLayer(r),e=this.drawLayers.getBounds(),t}},initialize:function(){if(!this.map){var e=this.$el.querySelector("#map");this.map=s().map(e).setView([51.505,-.09],2),s().tileLayer("//server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",{attribution:'Tiles © <a href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer">ArcGIS</a>',maxZoom:18,minZoom:1}).addTo(this.map),this.drawBboxes(),this.initDrawControl()}},initDrawControl:function(){if(!this.drawControl){this.drawControl=new(s().Control.Draw)({draw:{rectangle:{shapeOptions:{color:"#ff0000"}},circlemarker:!1,circle:!1,marker:!1,polygon:!1,polyline:!1},edit:{featureGroup:this.drawLayers}}),this.drawControl.addTo(this.map);var e=this;this.map.on(s().Draw.Event.CREATED,(function(t){t.layer;var a=t.layer.getBounds();e.bbox=e.drawValidBbox(a),e.change()})),this.map.on(s().Draw.Event.EDITED,(function(t){var a;t.layers.eachLayer((function(e){a=e.getBounds()})),e.bbox=e.drawValidBbox(a),e.change()})),this.map.on(s().Draw.Event.DELETED,(function(t){e.bbox={north:"",south:"",east:"",west:""},e.change()}))}}}};a(8721),a(6169),a(3875),a(7039);const i=(0,a(1900).Z)(n,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"draw-bbox"},[t("div",{staticClass:"fa fa-close",staticStyle:{position:"absolute",top:"0",right:"0px","z-index":"100",background:"white"},on:{click:e.close}}),e._v(" "),t("div",{staticStyle:{"z-index":"0"},attrs:{id:"map"}})])}),[],!1,null,"297e994a",null).exports},3875:(e,t,a)=>{var r=a(4707);r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals),(0,a(5346).Z)("2a03b568",r,!0,{})},7039:(e,t,a)=>{var r=a(1217);r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals),(0,a(5346).Z)("5e03a65c",r,!0,{})}}]);
//# sourceMappingURL=776.metadata-generator-vjs.js.map